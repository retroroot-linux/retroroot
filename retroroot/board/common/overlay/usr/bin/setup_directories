#!/usr/bin/env bash
set -e

DATA_DIR="/data/"
RETROARCH_DIR="/data/retroarch"
RETROARCH_CONFIG_DIR="${RETROARCH_DIR}/config"
RETROARCH_CONFIG_FILE="${RETROARCH_CONFIG_DIR}/retroarch.cfg"

setup_retroarch_dir() {
  if [ ! -d "${RETROARCH_DIR}" ]; then
    mkdir -p "${RETROARCH_DIR}"
  fi
  if [ ! -d "${RETROARCH_CONFIG_DIR}" ]; then
      mkdir -p "${RETROARCH_CONFIG_DIR}"
  fi
  if [ ! -e "${RETROARCH_CONFIG_FILE}" ]; then
    cp /etc/retroarch.cfg "${RETROARCH_CONFIG_FILE}"
  fi
}

setup_data_permissions() {
  chown -R root:retroarch "${DATA_DIR}"
  chmod -R 775 "${DATA_DIR}"
}

main() {
  setup_retroarch_dir
  setup_data_permissions
}

main "${@}"
